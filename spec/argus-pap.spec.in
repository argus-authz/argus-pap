## Turn off meaningless jar repackaging on SL6
%define __jar_repack 0

Name: argus-pap

Version: 1.5.0
Release: 1%{?dist}
Summary: Argus PAP service

Group: System Environment/Daemons
License: ASL 2.0
URL: https://twiki.cern.ch/twiki/bin/view/EGEE/AuthorizationFramework

Source: %{name}-%{version}.tar.gz
BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root-%(%{__id_u} -n)
BuildArch: noarch

BuildRequires: maven
BuildRequires: jpackage-utils
BuildRequires: java-devel

Requires: emi-trustmanager
Requires: emi-trustmanager-axis
Requires: voms-api-java
Requires: java

%description 

Argus is a system meant to render consistent authorization decisions for
distributed services (e.g. compute elements, portals). In order to achieve
this consistency a number of points must be addressed. First, it must be
possible to author and maintain consistent authorization policies. This is
handled by the Policy Administration Point (PAP) component in the service.
Second, authored policies must be evaluated in a consistent manner, a task
performed by the Policy Decision Point (PDP). Finally, the data provided for
evaluation against policies must be consistent (in form and definition) and
this is done by the Policy Enforcement Point (PEP).

This package provides the Argus PAP service.

%prep
%setup -q -n argus-pap

%build
mvn -B -s @@BUILD_SETTINGS@@ package

%install
rm -rf $RPM_BUILD_ROOT
mkdir -p $RPM_BUILD_ROOT
tar -C $RPM_BUILD_ROOT -xvzf target/%{name}-%{version}.tar.gz

%clean
rm -rf $RPM_BUILD_ROOT

%files

%defattr(-,root,root,-)

%{_initrddir}/argus-pap

%dir %{_sysconfdir}/argus/pap

%config(noreplace) %{_sysconfdir}/sysconfig/argus-pap
%config(noreplace) %{_sysconfdir}/argus/pap/pap_configuration.ini
%config(noreplace) %{_sysconfdir}/argus/pap/pap_authorization.ini
%config(noreplace) %{_sysconfdir}/argus/pap/pap-admin.properties

%{_sysconfdir}/argus/pap/attribute-mappings.ini

%dir %{_sysconfdir}/argus/pap/logging
%dir %{_sysconfdir}/argus/pap/logging/standalone
%dir %{_sysconfdir}/argus/pap/logging/client

%{_sysconfdir}/argus/pap/logging/standalone/logback.xml
%{_sysconfdir}/argus/pap/logging/client/logback.xml

%{_sbindir}/*
%{_bindir}/*

%{_datadir}/argus/pap
%{_datadir}/argus/pap/logs
%{_datadir}/argus/pap/conf
%{_datadir}/argus/pap/doc

%dir %{_datadir}/argus/pap/bin
%dir %{_datadir}/argus/pap/sbin

%{_datadir}/argus/pap/bin/*
%{_datadir}/argus/pap/sbin/*

%dir %{_datadir}/argus/pap/wars
%dir %{_datadir}/argus/pap/wsdl

%{_datadir}/argus/pap/wars/*
%{_datadir}/argus/pap/wsdl/*

%dir %{_docdir}/argus/pap
%{_docdir}/argus/pap/RELEASE-NOTES.txt
%{_docdir}/argus/pap/LICENSE.txt

%dir %{_sharedstatedir}/argus/pap
%dir %{_sharedstatedir}/argus/pap/repository
%dir %{_sharedstatedir}/argus/pap/lib
%dir %{_sharedstatedir}/argus/pap/lib/endorsed

%{_sharedstatedir}/argus/pap/lib/*.jar
%{_sharedstatedir}/argus/pap/lib/endorsed/*.jar

%dir %{_localstatedir}/log/argus/pap

%changelog

* Thu Mar 15 2012 Andrea Ceccanti <andrea.ceccanti at cnaf.infn.it> - 1.5.0-1
- Self managed packaging