<Policy RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" PolicyId="ProofOfConcept_01" xmlns:pboxpolicy="pbox:1.0:policy" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os">
    <Description>ProofOfConcept_01</Description>
    <Target>
        <Subjects/>
        <Resources/>
        <Actions>
            <Action>
                <ActionMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">job-submission</AttributeValue>
		    <ActionAttributeDesignator DataType="http://www.w3.org/2001/XMLSchema#string"
		        AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id"/>
		</ActionMatch>
	    </Action>
        </Actions>
	<Environments>
	    <Environment>
	        <EnvironmentMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		     <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Username</AttributeValue>
		     <EnvironmentAttributeDesignator AttributeId="urn:authz-interop:gt-egee-osg:names:xacml:attribute:obligationId"
		         DataType="http://www.w3.org/2001/XMLSchema#string"/>
		 </EnvironmentMatch>
		 <EnvironmentMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                     <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">UIDGID</AttributeValue>
                     <EnvironmentAttributeDesignator AttributeId="urn:authz-interop:gt-egee-osg:names:xacml:attribute:obligationId"
                         DataType="http://www.w3.org/2001/XMLSchema#string"/>
                 </EnvironmentMatch>
            </Environment>
	</Environments>
    </Target>
    <Rule RuleId="urn:gpbox:names:xacml:rule:SupportedObligationMatch" Effect="Permit">
    <Description>The set of obligations defined in this policy must match exactly the set of obligation specified in the request (cannot be a subset of)</Description>
        <Condition>
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of-all">
            <Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/>
            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-bag">
                <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Username</AttributeValue>
                <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">UIDGID</AttributeValue>
            </Apply>
            <EnvironmentAttributeDesignator
                AttributeId="urn:authz-interop:gt-egee-osg:names:xacml:attribute:obligationId"
                DataType="http://www.w3.org/2001/XMLSchema#string"/>
        </Apply>
        </Condition>
    </Rule>
    <Obligations>
        <Obligation ObligationId="urn:authz-interop:gt-egee-osg:names:xacml:attribute:Username" FulfillOn="Permit">
            <AttributeAssignment AttributeId="rn:authz-interop:gt-egee-osg:names:xacml:attribute:Username"
                DataType="http://www.w3.org/2001/XMLSchema#string">smith</AttributeAssignment>
        </Obligation>
        <Obligation ObligationId="urn:authz-interop:gt-egee-osg:names:xacml:attribute:uidgid" FulfillOn="Permit">
            <AttributeAssignment AttributeId="urn:authz-interop:gt-egee-osg:names:xacml:attribute:uid"
                DataType="http://www.w3.org/2001/XMLSchema#integer">2501</AttributeAssignment>
            <AttributeAssignment AttributeId="urn:authz-interop:gt-egee-osg:names:xacml:attribute:gid"
                DataType="http://www.w3.org/2001/XMLSchema#integer">2001</AttributeAssignment>
        </Obligation>
    </Obligations>
</Policy>
